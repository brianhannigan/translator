<controls:WindowExtension x:Class="Translator.MainWindow"
                          xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                          xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                          xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                          xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                          xmlns:local="clr-namespace:Translator"
                          xmlns:controls="clr-namespace:VTEControls.WPF;assembly=VTEControls"
                          xmlns:localControls="clr-namespace:Translator.Controls"
                          xmlns:converters="clr-namespace:Translator.Converters"
                          mc:Ignorable="d"
                          WindowStartupLocation="CenterScreen"
                          Background="{DynamicResource {x:Static SystemColors.ControlLightLightBrushKey}}"
                          Title="{StaticResource AppDisplayName}"
                          Height="781"
                          Width="1247">
    <Window.Resources>
        <converters:IndicatorConverter x:Key="IndicatorConverter" />
        <Style TargetType="{x:Type controls:Indicator}"
               x:Key="BaseIndicator">
            <Setter Property="OnColor"
                    Value="Green" />
            <Setter Property="OffColor"
                    Value="IndianRed" />
            <Setter Property="Height"
                    Value="15" />
            <Setter Property="Width"
                    Value="15" />
        </Style>
    </Window.Resources>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="Auto" />
        </Grid.ColumnDefinitions>
        <Menu x:Name="menu"
              Height="30"
              BorderBrush="DimGray"
              BorderThickness="1"
              VerticalAlignment="Center"
              VerticalContentAlignment="Center">
            <MenuItem Header="Settings"
                      Height="{Binding Height, ElementName=menu}">
                <MenuItem StaysOpenOnClick="True">
                    <MenuItem.Template>
                        <ControlTemplate>
                            <StackPanel Orientation="Vertical"
                                        Background="{DynamicResource {x:Static SystemColors.ControlLightLightBrushKey}}">
                                <StackPanel Orientation="Horizontal"
                                            Margin="5"
                                            HorizontalAlignment="Right">
                                    <TextBlock Text="Translation"
                                               FontWeight="DemiBold" />
                                    <TextBlock Text="IP Address: "
                                               FontStyle="Oblique"
                                               Margin="3,0,0,0"
                                               Grid.Column="0" />
                                    <TextBox Text="{Binding Path=NetworkManager.TranslationIpAddress}"
                                             Grid.Column="1"
                                             Margin="3,0,0,0"
                                             Width="75" />

                                    <TextBlock Text="Port: "
                                               FontStyle="Oblique"
                                               Margin="3,0,0,0"
                                               Grid.Column="2" />
                                    <TextBox Text="{Binding Path=NetworkManager.TranslationPort}"
                                             Grid.Column="3"
                                             Margin="3,0,0,0"
                                             Width="50" />
                                </StackPanel>
                                <Separator />
                                <StackPanel Orientation="Horizontal"
                                            Margin="5"
                                            HorizontalAlignment="Right">
                                    <TextBlock Text="OCR"
                                               FontWeight="DemiBold" />
                                    <TextBlock Text="IP Address: "
                                               FontStyle="Oblique"
                                               Margin="3,0,0,0"
                                               Grid.Column="0" />
                                    <TextBox Text="{Binding Path=NetworkManager.OcrIpAddress}"
                                             Grid.Column="1"
                                             Margin="3,0,0,0"
                                             Width="75" />

                                    <TextBlock Text="Port: "
                                               FontStyle="Oblique"
                                               Margin="3,0,0,0"
                                               Grid.Column="2" />
                                    <TextBox Text="{Binding Path=NetworkManager.OcrPort}"
                                             Grid.Column="3"
                                             Margin="3,0,0,0"
                                             Width="50" />
                                </StackPanel>
                            </StackPanel>
                        </ControlTemplate>
                    </MenuItem.Template>
                </MenuItem>
                <MenuItem Header="Translation Settings" Click="OpenTranslatorSettingsEditor_Click"   ToolTip="Edit the server and script configuration file." />
                <Separator />
                <MenuItem Header="Start Servers">
                    <StackPanel Orientation="Horizontal" Margin="5,0">
                        <Button x:Name="ToggleServerButton"
                                Width="110"
                                Height="24"
                                Content="{Binding ServerToggleText, RelativeSource={RelativeSource AncestorType=Window}}"
                                Click="ToggleServerButton_Click" />
                    </StackPanel>
                </MenuItem>
            </MenuItem>
            <MenuItem Header="Palette"
                      Height="{Binding Height, ElementName=menu}">
                <MenuItem Header="Edit"
                          Command="{Binding Path=PaletteManager.EditCommand}"
                          ToolTip="Opens an editor to modify the palette.">
                    <MenuItem.Icon>
                        <TextBlock Text="&#xE70F;"
                                   FontFamily="Segoe MDL2 Assets"
                                   HorizontalAlignment="Center"
                                   TextAlignment="Center"
                                   VerticalAlignment="Center" />
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="Import"
                          Command="{Binding Path=PaletteManager.ImportCommand}"
                          ToolTip="Imports and sets the palette." />
                <MenuItem Header="Export"
                          Command="{Binding Path=PaletteManager.ExportCommand}"
                          ToolTip="Exports the current applied palette." />
                <MenuItem Header="Reset"
                          Command="{Binding Path=PaletteManager.ResetCommand}"
                          ToolTip="Resets the palette to default." />
            </MenuItem>
        </Menu>        
        <StackPanel HorizontalAlignment="Right"
                    Orientation="Horizontal">
            <Grid Margin="5,0,5,0"
                  ToolTip="Status of the text translation server">
                <Grid.RowDefinitions>
                    <RowDefinition Height="*" />
                    <RowDefinition Height="auto" />
                </Grid.RowDefinitions>
                <controls:Indicator Status="{Binding Path=ServerManager.TranslatorStatus, RelativeSource={RelativeSource AncestorType=Window},Mode=OneWay, Converter={StaticResource IndicatorConverter}}"
                                    Style="{StaticResource BaseIndicator}"
                                    Margin="5,0,5,0" />
                <TextBlock Text="TRANSLATE"
                           Grid.Row="1"
                           FontSize="10"
                           FontWeight="DemiBold"
                           Margin="0,-3,0,0" />
            </Grid>
            <Separator Style="{StaticResource {x:Static ToolBar.SeparatorStyleKey}}" />
            <Grid Margin="5,0,5,0"
                  ToolTip="Status of the image ocr server">
                <Grid.RowDefinitions>
                    <RowDefinition Height="*" />
                    <RowDefinition Height="auto" />
                </Grid.RowDefinitions>
                <controls:Indicator Status="{Binding Path=ServerManager.OcrStatus, RelativeSource={RelativeSource AncestorType=Window},Mode=OneWay, Converter={StaticResource IndicatorConverter}}"
                                    Style="{StaticResource BaseIndicator}" />
                <TextBlock Text="OCR"
                           Grid.Row="1"
                           FontSize="10"
                           FontWeight="DemiBold"
                           Margin="0,-3,0,0" />
            </Grid>
            <Separator Style="{StaticResource {x:Static ToolBar.SeparatorStyleKey}}"
                       Visibility="{Binding ShowError, Converter={StaticResource BoolToVis}, UpdateSourceTrigger=PropertyChanged, FallbackValue=collapsed}" />
            <Button Background="IndianRed"
                    Margin="5,0,5,0"
                    BorderBrush="Black"
                    BorderThickness="1"
                    Width="25"
                    Height="25"
                    Command="{Binding ErrorDisplayCommand}"
                    Visibility="{Binding ShowError, Converter={StaticResource BoolToVis}, UpdateSourceTrigger=PropertyChanged, FallbackValue=collapsed}"
                    FontFamily="Segoe MDL2 Assets"
                    Content="&#xE8BB;"
                    Foreground="White"
                    FontWeight="Bold">
                <Button.Resources>
                    <Style TargetType="Border">
                        <Setter Property="CornerRadius"
                                Value="25" />
                    </Style>
                </Button.Resources>
            </Button>
        </StackPanel>
        <Grid Grid.Row="1"
              Background="{DynamicResource Brush.Primary}">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="auto" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="10" />
                <ColumnDefinition Width="auto" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>
            <TextBlock Style="{DynamicResource TextBlockStyle2}"
                       Grid.Column="1"
                       Margin="0,5"
                       Text="Source Language: " />
            <ComboBox Grid.Column="2"
                      Margin="0,5"
                      SelectedItem="{Binding Path=LanguageManager.SourceLanguage}"
                      ItemsSource="{Binding Path=LanguageManager.LanguageCodes, UpdateSourceTrigger=PropertyChanged}" />
            <TextBlock Style="{DynamicResource TextBlockStyle2}"
                       Grid.Column="4"
                       Margin="0,5"
                       Text="Target Language: " />
            <ComboBox Grid.Column="5"
                      Margin="0,5"
                      SelectedItem="{Binding Path=LanguageManager.TargetLanguage}"
                      ItemsSource="{Binding Path=LanguageManager.LanguageCodes, UpdateSourceTrigger=PropertyChanged}" />
        </Grid>
        <controls:TabControlExt x:Name="tabControl"
                                AllowDrop="True"
                                Grid.Column="0"
                                Grid.Row="2"
                                TabItemWidth="125"
                                ShowCheckBox="True"
                                HorizontalScrollBarVisibility="Auto" />

        <Grid x:Name="errorGrid"
              Grid.Row="0"
              Grid.RowSpan="3"
              Grid.Column="1"
              Width="300"
              Visibility="Collapsed"
              LostFocus="errorGrid_LostFocus"
              Background="{DynamicResource ControlBackground}">
            <Grid.RowDefinitions>
                <RowDefinition Height="*" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>
            <TextBox x:Name="errorLog"
                     IsReadOnly="True"
                     Background="{DynamicResource ControlBackground}"
                     Foreground="{DynamicResource ControlForeground}"
                     Margin="3"
                     TextWrapping="Wrap"
                     HorizontalScrollBarVisibility="Auto"
                     VerticalScrollBarVisibility="Auto"
                     BorderThickness="2" />

            <Button Style="{StaticResource AutoSizedButton}"
                    Grid.Row="1"
                    Command="{Binding Path=ErrorManager.ClearCommand}"
                    Content="Clear" />
        </Grid>
    </Grid>
</controls:WindowExtension>
